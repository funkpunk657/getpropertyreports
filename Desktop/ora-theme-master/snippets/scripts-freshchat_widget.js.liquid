!function e(t,n,a){function o(s,r){if(!n[s]){if(!t[s]){var d="function"==typeof require&&require;if(!r&&d)return d(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return o(n?n:e)},l,l.exports,e,t,n,a)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<a.length;s++)o(a[s]);return o}({1:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../obj/constants"),s=a(i),r=e("./../utils/common/dom"),d=a(r);n.default=function(){o(void 0,void 0);var e=function(e){27===e.keyCode&&this.destroy()};return{create:function(t){var n=document,a=n.body,o=n.createElement("DIV"),i=n.createElement("IMG"),r=n.createElement("DIV"),d=n.createElement("DIV");o.setAttribute("id",s.default.modalDivId),o.onclick=this.destroy,i.setAttribute("src",t),i.onclick=this.destory,d.appendChild(i),d.className="image-cell",r.appendChild(d),r.className="image-wrapper",o.appendChild(r),a.appendChild(o),window.addEventListener?window.addEventListener("keydown",e.bind(this),!1):window.attachEvent("keydown",e.bind(this),!1)},destroy:function(){var t=document,n=t.body,a=t.getElementById(s.default.modalDivId);a&&(d.default.purge(a),n.removeChild(a)),window.removeEventListener?window.removeEventListener("keydown",e.bind(this)):window.detachEvent("keydown",e.bind(this))}}}.bind(void 0)()},{"./../obj/constants":8,"./../utils/common/dom":12}],2:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./omni/transition"),i=a(o),s=e("./omni/activity"),r=a(s),d=e("./omni/delegation"),u=a(d);n.default={init:function(){i.default.start(),r.default.start(),u.default.start()},destroy:function(){i.default.stop(),r.default.stop(),u.default.stop()}}},{"./omni/activity":3,"./omni/delegation":5,"./omni/transition":6}],3:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../../utils/frame"),s=a(i),r=e("./../../utils/common/dom"),d=a(r);n.default=function(){o(void 0,void 0);var e=function(){o(void 0,void 0),s.default.postMessage({action:"track_activity",payload:{seen:n}})}.bind(void 0),t=null,n=null,a=null,i=function(){o(void 0,void 0),n=(new Date).getTime()}.bind(void 0),r=function(e){o(void 0,void 0),d.default.unbindEvent("keypress",i),d.default.unbindEvent("mousemove",i),d.default.unbindEvent("click",i),e&&(d.default.bindEvent("keypress",i),d.default.bindEvent("mousemove",i),d.default.bindEvent("click",i))}.bind(void 0),u=function(){o(void 0,void 0);var i=(new Date).getTime(),s=i-t;null===a||null===n||t&&(i<t||n<t||s<59e3||n>t&&n<i&&e()),t=i}.bind(void 0),l=function(){o(void 0,void 0),a&&clearInterval(a),a=null,n=null,t=null}.bind(void 0),f=function(){o(void 0,void 0),l(),r(!0),t=(new Date).getTime(),a=setInterval(u,6e4)}.bind(void 0),c=function(){o(void 0,void 0),n=(new Date).getTime(),e(),l(),r(!1)}.bind(void 0);return{start:function(){f(),d.default.bindEvent("focus",f),d.default.bindEvent("blur",c),d.default.bindEvent("unload",c)},stop:function(){c(),d.default.unbindEvent("focus",f),d.default.unbindEvent("blur",c),d.default.unbindEvent("unload",c)}}}.bind(void 0)()},{"./../../utils/common/dom":12,"./../../utils/frame":15}],4:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./../../obj/state"),i=a(o),s=e("./../../utils/frame"),r=a(s);n.default={track:function(e,t){return!!i.default.isLoaded()&&(r.default.postMessage({action:"track_event",payload:{eventName:e,data:t}}),!0)}}},{"./../../obj/state":9,"./../../utils/frame":15}],5:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../../utils/common/dom"),s=a(i),r=e("./analytics"),d=a(r);n.default=function(){o(void 0,void 0);var e=function(e){if(o(void 0,void 0),e){var t=e.target||e.srcElement,n=t&&t.getAttribute("data-fc-track"),a=s.default.parseJSON(n);t.id&&a&&d.default.track("click",a)}}.bind(void 0);return{start:function(){s.default.bindEvent("click",e)},stop:function(){s.default.unbindEvent("click",e)}}}.bind(void 0)()},{"./../../utils/common/dom":12,"./analytics":4}],6:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../../utils/common/observe"),s=a(i),r=e("./../../utils/frame"),d=a(r);n.default=function(){o(void 0,void 0);var e=void 0,t=void 0,n=void 0,a=function(a){e=a.oldValue,t=a.newValue,n=a.title,d.default.postMessage({action:"track_location",payload:{pageUrl:a}})},i=function(){var o=window.location.href;t!==o&&(e=t,t=o,n=document.title,a({oldValue:e,newValue:t,title:n}))};return{start:function(e){t=window.location.href,a({newValue:t,title:document.title}),s.default.attach(window.history,"pushState",i),s.default.attach(window.history,"replaceState",i),window.addEventListener?(window.addEventListener("hashchange",i,!1),window.addEventListener("popstate",i,!1)):(window.attachEvent("hashchange",i,!1),window.attachEvent("popstate",i,!1))},stop:function(){e=t=void 0,s.default.detach(window.history,"pushState"),s.default.detach(window.history,"replaceState"),window.removeEventListener?(window.removeEventListener("hashchange",i),window.removeEventListener("popstate",i)):(window.detachEvent("hashchange",i),window.detachEvent("popstate",i))}}}.bind(void 0)()},{"./../../utils/common/observe":13,"./../../utils/frame":15}],7:[function(e,t,n){"use strict";var a=e("./widget"),o=function(e){return e&&e.__esModule?e:{default:e}}(a);window.fcWidget||(window.fcWidget=o.default);var i=window.fcSettings;if(i){var s=i&&i.onInit;s&&"function"==typeof s&&s(),o.default.init(i)}},{"./widget":20}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={frameDivId:"fc_frame",frameId:"fc_widget",pushFrameDivId:"fc_push_frame",pushFrameId:"fc_push",modalDivId:"fc_web_modal"}},{}],9:[function(e,t,n){"use strict";function a(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){a(void 0,void 0);var e=!1,t=!1,n=!1,o=[],i={};return{isLoaded:function(){return e},loaded:function(t){e=t},isOpened:function(){return t},opened:function(e){t=e},doOpen:function(){return n},openOnLoad:function(e){n=e},getTags:function(){return o},setTags:function(e){o=e},getFaqTags:function(){return i},setFaqTags:function(e){i=e},reset:function(){e=!1,t=!1,n=!1,o=[],i={}}}}.bind(void 0)()},{}],10:[function(e,t,n){"use strict";function a(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){a(void 0,void 0);var e=null,t=null,n={},o={};return{getExternalId:function(){return e},setExternalId:function(t){e=t},getRestoreId:function(){return t},setRestoreId:function(e){t=e},getConfig:function(){return n},setConfig:function(e){n=e},getProperties:function(){return o},setProperties:function(e){o.firstName=e.firstName,o.lastName=e.lastName,o.email=e.email,o.phone=e.phone,o.phoneCountry=e.phoneCountry,this.setUserMeta(e.meta)},setFirstName:function(e){o.firstName=e},setLastName:function(e){o.lastName=e},setEmail:function(e){o.email=e},setPhone:function(e){o.phone=e},setPhoneCountry:function(e){o.phoneCountry=e},setUserMeta:function(e){if(o.meta=o.meta||{},e)for(var t in e)e.hasOwnProperty(t)&&(o.meta[t]=e[t])},reset:function(){e=null,t=null,n={},o={}},getJSON:function(){return{externalId:e,restoreId:t,customConfig:n,properties:o}}}}.bind(void 0)()},{}],11:[function(e,t,n){"use strict";function a(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./../frame"),i=function(e){return e&&e.__esModule?e:{default:e}}(o);n.default=function(){a(void 0,void 0);var e=function(){return i.default.getHost()+url.replace("{token}",i.default.getToken())},t=function(){if("XMLHttpRequest"in window)return new XMLHttpRequest;for(var e,t=["MSXML2.XmlHttp.6.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],n=0;n<t.length;n++)try{e=new ActiveXObject(t[n]);break}catch(e){}return e},n=function(e){if(e){void 0===e.async&&(e.async=!0);var n=t();n.open(e.type,e.url,e.async),n.onreadystatechange=function(){4===n.readyState&&e.success(JSON.parse(n.responseText))},"GET"!==e.type&&(e.contentType?n.setRequestHeader("Content-Type",e.contentType):n.setRequestHeader("Content-type","application/x-www-form-urlencoded")),e.data?n.send(e.data):n.send()}};return{getRequest:function(t,a){n({url:e(),type:"GET",success:a})},putRequest:function(t,a,o){n({url:e(),type:"PUT",data:JSON.stringify(a),contentType:"application/json; charset=UTF-8",success:o})}}}.bind(void 0)()},{"./../frame":15}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={url_domain:function(e){var t=document.createElement("a");return t.href=e,t.origin},setAttr:function(e,t){for(var n in t)t.hasOwnProperty(n)&&e.setAttribute(n,t[n]);return e},remove:function(e){var t=document,n=t.body,a=t.getElementById(e);a&&(this.purge(a),n.removeChild(a))},purge:function(e){var t,n,a,o=e.attributes;if(o)for(t=o.length-1;t>=0;t-=1)a=o[t].name,"function"==typeof e[a]&&(e[a]=null);if(o=e.childNodes)for(n=o.length,t=0;t<n;t+=1)this.purge(e.childNodes[t])},bindEvent:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];window.addEventListener?window.addEventListener(e,t,n):window.attachEvent(e,t,n)},unbindEvent:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];window.removeEventListener?window.removeEventListener(e,t,n):window.detachEvent(e,t,n)},parseJSON:function(e){var t;if(e){try{t=JSON.parse(e)}catch(e){}return t}},isPushSupportedByBrowser:function(){var e,t,n=!1,a=!1,o=function(){var e=!1;try{ServiceWorkerRegistration&&"showNotification"in ServiceWorkerRegistration.prototype&&(e=!0)}catch(e){}return e};(function(){var e=window.chrome,t=window.navigator,n=t.vendor,a=t.userAgent.indexOf("OPR")>-1,o=t.userAgent.indexOf("Edge")>-1;t.userAgent.match("CriOS");return null!==e&&void 0!==e&&"Google Inc."===n&&a===!1&&o===!1})()&&(e=function(){var e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!e&&parseInt(e[2],10)}())&&(n=e>=50),function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1}()&&(t=function(){var e=navigator.userAgent,t=e.indexOf("Firefox"),n=e.substring(t+8).split(".");return!(!n||!n.length)&&parseInt(n[0],10)}())&&(a=t>=44);var i="serviceWorker"in navigator,o=o(),s="PushManager"in window;return i&&o&&s&&(n||a)},getAgent:function(){var e,t,n,a=navigator.appVersion,o=navigator.userAgent,i=navigator.appName,s=""+parseFloat(a),r=parseInt(a,10);return(t=o.indexOf("Opera"))!==-1?(i="Opera",s=o.substring(t+6),(t=o.indexOf("Version"))!==-1&&(s=o.substring(t+8))):(t=o.indexOf("MSIE"))!==-1?(i="Microsoft Internet Explorer",s=o.substring(t+5)):(t=o.indexOf("Edge"))!==-1?(i="Edge",s=o.substring(t+5)):(t=o.indexOf("Trident"))!==-1?(i="Trident",s=o.substring(t+8)):(t=o.indexOf("Chrome"))!==-1?(i="Chrome",s=o.substring(t+7)):(t=o.indexOf("Safari"))!==-1?(i="Safari",s=o.substring(t+7),(t=o.indexOf("Version"))!==-1&&(s=o.substring(t+8))):(t=o.indexOf("Firefox"))!==-1?(i="Firefox",s=o.substring(t+8)):(e=o.lastIndexOf(" ")+1)<(t=o.lastIndexOf("/"))&&(i=o.substring(e,t),s=o.substring(t+1),i.toLowerCase()===i.toUpperCase()&&(i=navigator.appName)),(n=s.indexOf(";"))!==-1&&(s=s.substring(0,n)),(n=s.indexOf(" "))!==-1&&(s=s.substring(0,n)),r=parseInt(""+s,10),isNaN(r)&&(s=""+parseFloat(a),r=parseInt(a,10)),{name:i,version:r,versionx:s,os:navigator.platform}}()}},{}],13:[function(e,t,n){"use strict";function a(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){a(void 0,void 0);var e=function(e,t,n){var a=e[t];e[t]=function(){var t=a.apply(e,arguments);return"function"==typeof e[n]&&e[n](),t}};return{attach:function(t,n,a){var o=n+"Observer";t[o]=a,t[n]&&e(t,n,o)},detach:function(e,t){e[t+"Observer"]=void 0}}}.bind(void 0)()},{}],14:[function(e,t,n){"use strict";function a(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){a(void 0,void 0);var e={},t=["widget:opened","widget:closed","widget:loaded","user:created","user:cleared","message:sent","message:received","unreadCount:notify","push:subscribed"];return{clear:function(){e={}},valid:function(e){return!(!e||!t)&&t.indexOf(e)!==-1},subscribe:function(t,n){this.valid(t)&&(void 0===e[t]&&(e[t]=[]),e[t].push(n))},unsubscribe:function(t,n){if(this.valid(t)){var a,o=e&&e[t];if(o)for(var i=0,s=o.length;i<s;i++)if(a=o[i],isFunction(a)&&(!n||a.name===n.name)){e.splice(i,1);break}}},publish:function(t,n){if(this.valid(t)){var a,o=e&&e[t];if(o)for(var i=0,s=o.length;i<s;i++)a=o[i],n?a(n):a()}}}}.bind(void 0)()},{}],15:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../obj/constants"),s=a(i),r=e("./../obj/user"),d=a(r),u=e("./common/dom"),l=a(u);n.default=function(){o(void 0,void 0);var e=null,t=null,n=null,a=null,i=null;return{getHost:function(){return i},getToken:function(){return t},getReferrer:function(){return n},getSiteId:function(){return a},init:function(e){t=e.token,n=e.referrer,i=e.host,a=e.siteId},getJSON:function(){return{token:t,referrer:n,host:i,siteId:a}},load:function(t,n){e=window.open(t,n)},postMessage:function(t){e&&e.postMessage(t,i)},dispatch:function(e,t){e&&t&&"function"==typeof e&&e(t)},unload:function(){this.postMessage({action:"push_subscribe_destroy"})},add:function(){var e=document,a=e.body,o=e.getElementById(s.default.frameDivId),r=e.createElement("IFRAME");d.default.getExternalId(),d.default.getRestoreId();if(!o){var u=d.default.getConfig(),f=u&&u.cssNames;o=e.createElement("DIV"),l.default.setAttr(o,{id:s.default.frameDivId,class:f&&f.widget||""}),u&&u.headerProperty&&("ltr"===u.headerProperty.direction&&o.classList.add("fc_l2r"),u.headerProperty.hideChatButton&&o.classList.add("fc_dn")),l.default.setAttr(r,{id:s.default.frameId,name:s.default.frameId,frameborder:"0"}),o.appendChild(r),a.appendChild(o),this.load(i+"/widget/"+t+"/"+n,s.default.frameId)}},remove:function(t){l.default.remove(t),e=null}}}.bind(void 0)()},{"./../obj/constants":8,"./../obj/user":10,"./common/dom":12}],16:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./common/dom"),i=a(o),s=e("./frame"),r=a(s),d=e("./events"),u=a(d),l=e("./common/ajax"),f=(a(l),e("../obj/constants")),c=a(f),p=e("../obj/state"),m=a(p),v=e("../obj/user"),g=a(v),h=e("./msg_handler"),b=a(h),w=e("./push_frame"),y=a(w),_=e("../helpers/modal"),E=a(_),M=e("../helpers/omni"),I=a(M);n.default={subscribe:function(e){window.addEventListener?(window.addEventListener("message",this.onMessage.bind(this),!1),window.addEventListener("focus",this.onVisibilityChange,!1),window.addEventListener("blur",this.onVisibilityChange,!1)):(window.attachEvent("onmessage",this.onMessage.bind(this)),window.attachEvent("focus",this.onVisibilityChange),window.attachEvent("blur",this.onVisibilityChange))},unsubscribe:function(){window.removeEventListener?(window.removeEventListener("message",this.onMessage,!1),window.removeEventListener("focus",this.onVisibilityChange,!1),window.removeEventListener("blur",this.onVisibilityChange,!1)):(window.detachEvent("onmessage",this.onMessage),window.detachEvent("focus",this.onVisibilityChange),window.detachEvent("blur",this.onVisibilityChange))},onVisibilityChange:function(e){switch(e.type){case"focus":r.default.postMessage({action:"widget_focus"});break;case"blur":r.default.postMessage({action:"widget_blur",payload:{title:document.title,location:window.location.href}}),y.default.postMessage({action:"widget_location",openWindow:!1,payload:window.location.href})}},onUserCreate:function(e){u.default.publish("user:created",e)},onMessage:function(e){var t=e.origin||e.originalEvent.origin,n=g.default.getConfig(),a=n&&n.cssNames;if(t===r.default.getHost()||t===y.default.getHostOrigin()){var o=e.data,s=o&&o.action;if(s)switch(s){case"push_subscribe_destroy_response":m.default.reset(),g.default.reset(),u.default.clear(),r.default.remove(c.default.frameDivId),I.default.destroy(),this.unsubscribe();break;case"push_user_meta":u.default.publish("push:subscribed",o.data),r.default.postMessage(o);break;case"notify_frame":var o=o.data,d=document.getElementById(c.default.frameDivId),l=a&&a.open||"open";"expand"===o?(d.removeAttribute("style"),d.classList.add("h-open-notify"),d.classList.add(l),d.classList.add(o)):"close"===o?(d.removeAttribute("style"),d.classList.remove("h-open-notify"),d.classList.remove(l),d.classList.remove("expand")):(d.classList.add("h-open-notify"),d.classList.add(l));break;case"resize_frame_notify":var f=o.data+96+24,p=g.default.getConfig()&&g.default.getConfig().headerProperty;p&&p.hideChatButton&&(f-=96),document.getElementById(c.default.frameDivId).setAttribute("style","height:"+f+"px !important;");break;case"resize_frame":var v=document.getElementById(c.default.frameDivId),h=document.getElementsByTagName("BODY")[0],l=a&&a.open||"open";m.default.opened(o.isOpen),m.default.isOpened()?(v.classList.add("h-open-container"),v.classList.add(l),u.default.publish("widget:opened"),h&&h.classList.add("fc-widget-open")):(v.classList.remove("h-open-container"),v.classList.remove(l),u.default.publish("widget:closed"),h&&h.classList.remove("fc-widget-open"));break;case"toggle_frame":var v=document.getElementById(c.default.frameDivId);o.show?v.classList.remove("hide"):v.className.trim().indexOf("hide")===-1&&v.classList.add("hide");break;case"push_frame_loaded":y.default.loaded(!0),y.default.setSource(e&&e.source),y.default.postMessage({action:"widget_location",openWindow:!1,payload:window.location.href}),r.default.postMessage({action:"widget_location",payload:{title:document.title,location:window.location.href}});break;case"frame_initialized":var w=r.default.getJSON(),_=g.default.getProperties(),M=g.default.getConfig();w.externalId=g.default.getExternalId(),w.restoreId=g.default.getRestoreId(),_&&(w.properties=_),M&&(w.config=M),w.userAgent=i.default.getAgent,r.default.postMessage({action:"load_widget",payload:w});break;case"frame_loaded":m.default.loaded(!0),u.default.publish("widget:loaded"),y.default.isLoaded()||y.default.init({host:o.pushDomain+"?ref="+btoa(window.location.origin),hostOrigin:i.default.url_domain(o.pushDomain),appLogoPath:o.appLogoPath}),m.default.doOpen()&&r.default.postMessage({action:"open_chat"}),m.default.getTags()&&r.default.postMessage({action:"set_tags",payload:{tags:m.default.getTags()}}),m.default.getFaqTags()&&r.default.postMessage({action:"set_faq_tags",payload:{faqTags:m.default.getFaqTags()}});break;case"datastore_loaded":r.default.postMessage({action:"load_rules"});break;case"rules_loaded":I.default.init();break;case"enlarge_image":E.default.create(o.picUrl);break;case"expand_all":var C=a&&a.expanded||"expanded";document.getElementById(c.default.frameDivId).classList.add("expanded-modal"),document.getElementById(c.default.frameDivId).classList.add(C);break;case"collapse_all":var C=a&&a.expanded||"expanded";document.getElementById(c.default.frameDivId).classList.remove("expanded-modal"),document.getElementById(c.default.frameDivId).classList.remove(C);break;case"user_created":var L=o.data;if(m.default.isLoaded())L&&g.default.setRestoreId(L.restoreId),this.onUserCreate(o);else if(o.success){var O=L&&L.externalId,k=L&&L.restoreId,x=g.default.getExternalId();x?x===O&&(g.default.setRestoreId(k),this.onUserCreate(o)):this.onUserCreate(o)}else this.onUserCreate(o);break;case"user_cleared":u.default.publish("user:cleared"),y.default.postMessage({action:"clear:subscription",openWindow:!1}),g.default.reset();break;case"message_sent":u.default.publish("message:sent",o);break;case"message_received":u.default.publish("message:received",o);break;case"ask_permission":y.default.postMessage({action:"ask:permission",openWindow:!0});break;case"clear_subscription":y.default.postMessage({action:"clear:subscription",openWindow:!1});break;case"unread_count_notify":u.default.publish("unreadCount:notify",o.data);break;default:b.default.publish(s,o)}}},syncResponse:function(e,t){var n=e&&e.status;n?r.default.dispatch(t,{success:200===n,status:n}):r.default.dispatch(t,{success:!1,status:400})}}},{"../helpers/modal":1,"../helpers/omni":2,"../obj/constants":8,"../obj/state":9,"../obj/user":10,"./common/ajax":11,"./common/dom":12,"./events":14,"./frame":15,"./msg_handler":17,"./push_frame":19}],17:[function(e,t,n){"use strict";function a(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./frame"),i=function(e){return e&&e.__esModule?e:{default:e}}(o);n.default=function(){a(void 0,void 0);var e={};return{subscribe:function(t,n,a){e[t+"_ack"]=a,i.default.postMessage({action:t,payload:n})},publish:function(t,n){i.default.dispatch(e[t],{success:n.success,status:n.status,data:n.data})}}}.bind(void 0)()},{"./frame":15}],18:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("../obj/state"),i=a(o),s=e("./msg_handler"),r=a(s);n.default={send:function(e,t){return i.default.isLoaded()?new Promise(function(n,a){r.default.subscribe(e,t,function(e){200===(e&&e.status)?n(e):a(e)})}):Promise.reject({success:!1,status:404})}}},{"../obj/state":9,"./msg_handler":17}],19:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./common/dom"),s=a(i),r=e("../obj/constants"),d=a(r);n.default=function(){o(void 0,void 0);var e=null,t=null,n=null,a=!1,i=null;return{isLoaded:function(){return a},loaded:function(e){a=e},getSource:function(){return i},setSource:function(e){i=e},getHost:function(){return e},getHostOrigin:function(){return t},getLogoPath:function(){return n},init:function(a){e=a.host,t=a.hostOrigin,n=a.appLogoPath,this.load()},reset:function(){e=null,t=null,n=null,a=!1,i=null},postMessage:function(t){t.openWindow?window.open(e+"&action="+btoa(t.action)+"&appLogoPath="+btoa(n),"_blank","toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=500,width=400,height=400"):a&&this.post({action:t.action,payload:t.payload})},post:function(e){i.postMessage(e,t)},add:function(){var t=document,n=t.body,a=t.getElementById(d.default.pushFrameDivId),o=t.createElement("IFRAME");a||(a=t.createElement("DIV"),a.setAttribute("id",d.default.pushFrameDivId),s.default.setAttr(o,{id:d.default.pushFrameId,src:e,frameborder:"0"}),a.appendChild(o),n.appendChild(a))},load:function(){s.default.isPushSupportedByBrowser()&&this.add()},unload:function(){s.default.remove(d.default.pushFrameDivId),this.reset()}}}.bind(void 0)()},{"../obj/constants":8,"./common/dom":12}],20:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./obj/constants"),s=a(i),r=e("./obj/state"),d=a(r),u=e("./obj/user"),l=a(u),f=e("./utils/msg_promise"),c=a(f),p=e("./utils/common/dom"),m=a(p),v=e("./utils/frame"),g=a(v),h=e("./utils/message"),b=a(h),w=e("./utils/events"),y=a(w),_=e("./utils/common/ajax"),E=(a(_),e("./utils/push_frame")),M=a(E),I=e("./helpers/omni/analytics"),C=a(I);n.default=function(){o(void 0,void 0);var e=function(e){d.default.reset(),l.default.reset(),g.default.init({host:e.host,token:e.token,referrer:e.referrer,siteId:e.siteId}),d.default.openOnLoad(e.open),e.externalId&&(l.default.setExternalId(e.externalId),l.default.setRestoreId(e.restoreId)),e.tags&&e.tags.length&&d.default.setTags(e.tags),e.faqTags&&d.default.setFaqTags(e.faqTags),l.default.setProperties({firstName:e.firstName,lastName:e.lastName,email:e.email,phone:e.phone,phoneCountry:e.phoneCountryCode,meta:e.meta}),l.default.setConfig(e.config),e.onLoad&&y.default.subscribe("widget:loaded",e.onLoad),g.default.add(),b.default.subscribe(),t()},t=function(){var e=document,t=e.createElement("link");t.href=g.default.getHost()+"/assets/widget/widget.css?t="+(new Date).getTime(),t.rel="stylesheet",e.getElementsByTagName("head")[0].appendChild(t)};return{init:function(t){if(["Chrome","Firefox","Safari","Edge","Trident"].indexOf(m.default.getAgent.name)!==-1){t&&t.token&&(t.referrer||(t.referrer=btoa(window.location.origin)),void 0===t.open&&(t.open=!1),e(t))}},destroy:function(){M.default.unload(),g.default.unload()},isOpen:function(){return d.default.isOpened()},isInitialized:function(){return!!g.default.getToken()},isLoaded:function(){return d.default.isLoaded()},on:function(e,t){y.default.subscribe(e,t)},off:function(e,t){y.default.unsubscribe(e,t)},open:function(e){e?g.default.postMessage({action:"open_channel",payload:e}):g.default.postMessage({action:"open_chat"})},close:function(){g.default.postMessage({action:"close_chat"})},show:function(){g.default.postMessage({action:"show_chat"})},hide:function(){g.default.postMessage({action:"hide_chat"})},setTags:function(e){d.default.isLoaded()&&(e&&e.length?d.default.setTags(e):d.default.setTags([]),g.default.postMessage({action:"set_tags",payload:{tags:d.default.getTags(),force:!0}}))},setFaqTags:function(e){d.default.isLoaded()&&(e?d.default.setFaqTags(e):d.default.setFaqTags({}),g.default.postMessage({action:"set_faq_tags",payload:{faqTags:d.default.getFaqTags(),force:!0}}))},setExternalId:function(e){return c.default.send("set_external_id",{externalId:e})},setConfig:function(e){var t=document.getElementById(s.default.frameDivId);t&&e&&e.headerProperty&&(void 0!==e.headerProperty.direction&&(t.classList.remove("fc_l2r"),"ltr"===e.headerProperty.direction&&t.classList.add("fc_l2r")),void 0!==e.headerProperty.hideChatButton&&(t.classList.remove("fc_dn"),e.headerProperty.hideChatButton&&t.classList.add("fc_dn"))),g.default.postMessage({action:"set_custom_config",payload:e})},user:{get:function(){return c.default.send("get_user")},update:function(e){return e.firstName&&l.default.setFirstName(e.firstName),e.lastName&&l.default.setLastName(e.lastName),e.email&&l.default.setEmail(e.email),e.phone&&l.default.setPhone(e.phone),e.phoneCountry&&l.default.setPhoneCountry(e.phoneCountry),e.meta&&l.default.setUserMeta(e.meta),c.default.send("update_user",e)},setProperties:function(e){var t={};return e.firstName&&(t.firstName=e.firstName,e.firstName=void 0),e.lastName&&(t.lastName=e.lastName,e.lastName=void 0),e.email&&(t.email=e.email,e.email=void 0),e.phone&&(t.phone=e.phone,e.phone=void 0),e.phoneCountryCode&&(t.phoneCountry=e.phoneCountryCode,e.phoneCountryCode=void 0),t.meta=e,l.default.setProperties(t),c.default.send("set_user_properties",t)},clear:function(){return c.default.send("reset_user")},create:function(e){return c.default.send("create_user",e)}},track:C.default.track}}.bind(void 0)()},{"./helpers/omni/analytics":4,"./obj/constants":8,"./obj/state":9,"./obj/user":10,"./utils/common/ajax":11,"./utils/common/dom":12,"./utils/events":14,"./utils/frame":15,"./utils/message":16,"./utils/msg_promise":18,"./utils/push_frame":19}]},{},[7]);